<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Minesweeper">
<title>Minesweeper</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{width:100%;height:100%;overflow:hidden}
body{
  font-family:-apple-system,BlinkMacSystemFont,'Helvetica Neue',sans-serif;
  background:#1a1a2e;color:#e0e0e0;
  display:flex;flex-direction:column;align-items:center;justify-content:space-evenly;
  height:100vh;height:100dvh;
  padding:6px 8px;
  user-select:none;-webkit-user-select:none;
}
h1{font-size:1.1rem;font-weight:700;letter-spacing:.15em;text-transform:uppercase;color:#e94560}

.topbar{display:flex;align-items:center;justify-content:space-between;width:100%;max-width:400px}
.info{display:flex;gap:12px;align-items:center}
.info span{font-family:monospace;font-size:.9rem;color:#aaa;font-weight:700}
.info .mc{color:#e94560}

.dbtn{display:flex;gap:5px}
.dbtn button{
  font-family:inherit;font-size:.6rem;font-weight:700;
  padding:4px 8px;border:none;border-radius:20px;
  background:#16213e;color:#888;text-transform:uppercase;letter-spacing:.04em;cursor:pointer;
}
.dbtn button.on{background:#e94560;color:#fff}

.actions{display:flex;gap:6px;width:100%;max-width:400px;justify-content:center}
.actions button{
  font-family:inherit;font-size:.7rem;font-weight:700;
  padding:6px 14px;border:none;border-radius:16px;
  background:#16213e;color:#aaa;cursor:pointer;
}
.actions button.on{background:#e94560;color:#fff}

.board-wrap{
  width:100%;max-width:400px;
  overflow:hidden;
  border:3px solid #e94560;
  border-radius:6px;
  touch-action:manipulation;
}
.board{display:grid;width:100%}
.cell{
  aspect-ratio:1;
  display:flex;align-items:center;justify-content:center;
  background:#16213e;
  border:1px solid #2a2a4a;
  font-weight:800;
  font-size:clamp(.55rem,2.8vw,.95rem);
  cursor:pointer;
  transition:background .1s;
}
.cell.rev{background:#0f0f23;cursor:default}
.cell.rev.mine{background:rgba(233,69,96,.2)}
.cell.flag::after{content:'ðŸš©';font-size:clamp(.5rem,2.5vw,.85rem)}
.cell.boom{background:#e94560!important}
.cell.n1{color:#4fc3f7}.cell.n2{color:#66bb6a}.cell.n3{color:#ef5350}.cell.n4{color:#7e57c2}
.cell.n5{color:#ff7043}.cell.n6{color:#26c6da}.cell.n7{color:#ec407a}.cell.n8{color:#bdbdbd}

.ov{
  position:fixed;top:0;left:0;right:0;bottom:0;
  background:rgba(26,26,46,.93);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:12px;z-index:10;visibility:hidden;opacity:0;transition:opacity .3s;
}
.ov.show{visibility:visible;opacity:1}
.ov h2{font-size:1.6rem;color:#e94560}
.ov p{color:#aaa;font-size:1rem;text-align:center}
.ov button{
  font-family:inherit;padding:12px 28px;border:none;border-radius:30px;
  background:#e94560;color:#fff;font-size:1rem;font-weight:700;cursor:pointer;
}
</style>
</head>
<body>

<h1>MINESWEEPER</h1>

<div class="topbar">
  <div class="dbtn" id="db">
    <button data-d="easy" class="on">Easy</button>
    <button data-d="medium">Med</button>
    <button data-d="hard">Hard</button>
  </div>
  <div class="info">
    <span class="mc" id="mc">ðŸ’£ 10</span>
    <span id="tmr">00:00</span>
  </div>
</div>

<div class="actions">
  <button id="flagBtn">ðŸš© Flag</button>
  <button id="newBtn">â†» New</button>
</div>

<div class="board-wrap">
  <div class="board" id="brd"></div>
</div>

<div class="ov" id="ov">
  <h2 id="ovT">ðŸ’£ Game Over</h2>
  <p id="ovM"></p>
  <button id="ovB">New Game</button>
</div>

<script>
(function(){
  var CFG={easy:{r:9,c:9,m:10},medium:{r:12,c:10,m:25},hard:{r:14,c:10,m:40}};
  var diff='easy',R,C,M,brd,rev,flg,mines,over,won,first,fmode=false;
  var tsec,tint;
  var brdEl=document.getElementById('brd'),mcEl=document.getElementById('mc');
  var tmrEl=document.getElementById('tmr'),ov=document.getElementById('ov');
  var ovT=document.getElementById('ovT'),ovM=document.getElementById('ovM');
  var flagBtn=document.getElementById('flagBtn');

  function newGame(d){
    if(d)diff=d;
    var cfg=CFG[diff];R=cfg.r;C=cfg.c;M=cfg.m;
    brd=[];rev=[];flg=[];mines=new Set();
    over=false;won=false;first=true;fmode=false;
    flagBtn.className='';
    if(tint)clearInterval(tint);tsec=0;updT();
    ov.className='ov';updD();build();updMC();
  }

  function updD(){var bs=document.getElementById('db').children;for(var i=0;i<bs.length;i++)bs[i].className=bs[i].getAttribute('data-d')===diff?'on':'';}
  function updT(){var m=Math.floor(tsec/60),s=tsec%60;tmrEl.textContent=(m<10?'0':'')+m+':'+(s<10?'0':'')+s;}
  function updMC(){var f=0;for(var r=0;r<R;r++)for(var c=0;c<C;c++)if(flg[r][c])f++;mcEl.textContent='ðŸ’£ '+(M-f);}

  function build(){
    brdEl.innerHTML='';
    brdEl.style.gridTemplateColumns='repeat('+C+',1fr)';
    for(var r=0;r<R;r++){brd[r]=[];rev[r]=[];flg[r]=[];for(var c=0;c<C;c++){
      brd[r][c]=0;rev[r][c]=false;flg[r][c]=false;
      var d=document.createElement('div');d.className='cell';
      d.setAttribute('data-r',r);d.setAttribute('data-c',c);
      brdEl.appendChild(d);
    }}
  }

  function placeMines(sr,sc){
    var safe=new Set();
    for(var dr=-1;dr<=1;dr++)for(var dc=-1;dc<=1;dc++){var nr=sr+dr,nc=sc+dc;if(nr>=0&&nr<R&&nc>=0&&nc<C)safe.add(nr*C+nc);}
    mines=new Set();
    while(mines.size<M){var idx=Math.floor(Math.random()*R*C);if(!safe.has(idx)&&!mines.has(idx))mines.add(idx);}
    mines.forEach(function(idx){brd[Math.floor(idx/C)][idx%C]=-1;});
    for(var r=0;r<R;r++)for(var c=0;c<C;c++){
      if(brd[r][c]===-1)continue;var ct=0;
      for(var dr=-1;dr<=1;dr++)for(var dc=-1;dc<=1;dc++){if(dr===0&&dc===0)continue;var nr=r+dr,nc=c+dc;if(nr>=0&&nr<R&&nc>=0&&nc<C&&brd[nr][nc]===-1)ct++;}
      brd[r][c]=ct;
    }
  }

  function gc(r,c){return brdEl.children[r*C+c];}

  function reveal(r,c){
    if(r<0||r>=R||c<0||c>=C||rev[r][c]||flg[r][c])return;
    rev[r][c]=true;var cell=gc(r,c);cell.classList.add('rev');
    if(brd[r][c]===-1){cell.textContent='ðŸ’£';cell.classList.add('mine');return;}
    if(brd[r][c]>0){cell.textContent=brd[r][c];cell.classList.add('n'+brd[r][c]);return;}
    for(var dr=-1;dr<=1;dr++)for(var dc=-1;dc<=1;dc++){if(dr===0&&dc===0)continue;reveal(r+dr,c+dc);}
  }

  function revealAll(){
    for(var r=0;r<R;r++)for(var c=0;c<C;c++){
      if(brd[r][c]===-1){rev[r][c]=true;var cell=gc(r,c);cell.classList.add('rev','mine');cell.textContent='ðŸ’£';}
    }
  }

  function chkWin(){
    var u=0;for(var r=0;r<R;r++)for(var c=0;c<C;c++)if(!rev[r][c])u++;
    if(u===M){
      won=true;over=true;clearInterval(tint);
      var m=Math.floor(tsec/60),s=tsec%60;
      ovT.textContent='ðŸŽ‰ You Win!';
      ovM.textContent='Cleared in '+m+'m '+(s<10?'0':'')+s+'s';
      setTimeout(function(){ov.className='ov show';},300);
    }
  }

  function handleTap(r,c){
    if(over)return;
    if(first){first=false;placeMines(r,c);tint=setInterval(function(){tsec++;updT();},1000);}
    if(fmode){
      if(rev[r][c])return;
      flg[r][c]=!flg[r][c];gc(r,c).classList.toggle('flag');updMC();return;
    }
    if(flg[r][c])return;
    if(brd[r][c]===-1){
      over=true;clearInterval(tint);
      gc(r,c).classList.add('boom');revealAll();
      ovT.textContent='ðŸ’£ Game Over';ovM.textContent='You hit a mine!';
      setTimeout(function(){ov.className='ov show';},500);
      return;
    }
    reveal(r,c);chkWin();
  }

  // Chord (tap revealed number to auto-reveal neighbors if flags match)
  function handleChord(r,c){
    if(!rev[r][c]||brd[r][c]<=0)return;
    var fc=0;
    for(var dr=-1;dr<=1;dr++)for(var dc=-1;dc<=1;dc++){
      if(dr===0&&dc===0)continue;
      var nr=r+dr,nc=c+dc;
      if(nr>=0&&nr<R&&nc>=0&&nc<C&&flg[nr][nc])fc++;
    }
    if(fc!==brd[r][c])return;
    for(var dr=-1;dr<=1;dr++)for(var dc=-1;dc<=1;dc++){
      if(dr===0&&dc===0)continue;
      var nr=r+dr,nc=c+dc;
      if(nr>=0&&nr<R&&nc>=0&&nc<C&&!rev[nr][nc]&&!flg[nr][nc]){
        if(brd[nr][nc]===-1){
          over=true;clearInterval(tint);
          gc(nr,nc).classList.add('boom');revealAll();
          ovT.textContent='ðŸ’£ Game Over';ovM.textContent='You hit a mine!';
          setTimeout(function(){ov.className='ov show';},500);
          return;
        }
        reveal(nr,nc);
      }
    }
    chkWin();
  }

  brdEl.addEventListener('click',function(e){
    var t=e.target.closest('.cell');if(!t)return;
    var r=parseInt(t.getAttribute('data-r')),c=parseInt(t.getAttribute('data-c'));
    if(rev[r][c]&&brd[r][c]>0){handleChord(r,c);}
    else{handleTap(r,c);}
  });

  // Long press to flag on mobile
  var lpt=null,lpr=-1,lpc=-1;
  brdEl.addEventListener('touchstart',function(e){
    var t=e.target.closest('.cell');if(!t)return;
    lpr=parseInt(t.getAttribute('data-r'));lpc=parseInt(t.getAttribute('data-c'));
    lpt=setTimeout(function(){
      if(over||rev[lpr][lpc])return;
      flg[lpr][lpc]=!flg[lpr][lpc];gc(lpr,lpc).classList.toggle('flag');updMC();
      lpr=-1;lpc=-1;
    },400);
  },{passive:true});
  brdEl.addEventListener('touchend',function(){if(lpt){clearTimeout(lpt);lpt=null;}},{passive:true});
  brdEl.addEventListener('touchmove',function(){if(lpt){clearTimeout(lpt);lpt=null;}},{passive:true});

  flagBtn.addEventListener('click',function(){fmode=!fmode;flagBtn.className=fmode?'on':'';});
  document.getElementById('newBtn').addEventListener('click',function(){newGame();});
  document.getElementById('ovB').addEventListener('click',function(){newGame();});

  var dbs=document.getElementById('db').children;
  for(var i=0;i<dbs.length;i++){
    dbs[i].addEventListener('click',(function(b){return function(){newGame(b.getAttribute('data-d'));};})(dbs[i]));
  }

  newGame();
})();
</script>
<!-- ORIENTATION GUARD â€” auto shows rotate message when needed -->
<script>
!function(){
  var I='og2-overlay';
  function isTablet(){return Math.min(screen.width,screen.height)>=600}
  function needsRotate(){var l=window.innerWidth>window.innerHeight;return isTablet()?!l:l}

  function build(){
    if(document.getElementById(I))return;

    /* â”€â”€ Styles â”€â”€ */
    var s=document.createElement('style');
    s.textContent=
      '#'+I+'{display:none;position:fixed;inset:0;'+
        'background:linear-gradient(135deg,#0e1218 0%,#1a1f2e 50%,#0e1218 100%);'+
        'z-index:99999;flex-direction:column;align-items:center;justify-content:center;'+
        'font-family:-apple-system,Arial,sans-serif;text-align:center;'+
        'padding:32px;box-sizing:border-box;overflow:hidden}'+
      '#'+I+'.og2-show{display:flex}'+

      /* Glow pulse */
      '#'+I+'::before{content:"";position:absolute;width:300px;height:300px;'+
        'background:radial-gradient(circle,rgba(103,126,234,.18) 0%,transparent 70%);'+
        'border-radius:50%;animation:og2-glow 2.5s ease-in-out infinite}'+
      '@keyframes og2-glow{0%,100%{transform:scale(1);opacity:.5}50%{transform:scale(1.35);opacity:1}}'+

      /* Phone wrap */
      '#og2-phone{position:relative;width:90px;height:90px;'+
        'display:flex;align-items:center;justify-content:center;'+
        'margin-bottom:28px;animation:og2-rot 2.4s ease-in-out infinite}'+
      '@keyframes og2-rot{0%{transform:rotate(0)}35%,65%{transform:rotate(90deg)}100%{transform:rotate(0)}}'+

      /* Phone SVG glow */
      '#og2-phone svg{width:56px;height:90px;'+
        'filter:drop-shadow(0 0 12px rgba(103,126,234,.9)) drop-shadow(0 0 28px rgba(103,126,234,.4))}'+

      /* Arrows */
      '#og2-al,#og2-ar{position:absolute;font-size:24px;opacity:0;'+
        'color:#a78bfa;text-shadow:0 0 10px rgba(167,139,250,.9)}'+
      '#og2-al{left:-2px;animation:og2-ala 2.4s ease-in-out infinite}'+
      '#og2-ar{right:-2px;animation:og2-ara 2.4s ease-in-out infinite}'+
      '@keyframes og2-ala{0%,20%{opacity:0;transform:translateX(6px)}40%{opacity:1;transform:translateX(0)}70%,100%{opacity:0;transform:translateX(-6px)}}'+
      '@keyframes og2-ara{0%,20%{opacity:0;transform:translateX(-6px)}40%{opacity:1;transform:translateX(0)}70%,100%{opacity:0;transform:translateX(6px)}}'+

      /* Title & sub */
      '#og2-title{font-size:1.15rem;font-weight:700;color:#e8edf5;letter-spacing:.05em;margin-bottom:10px;position:relative}'+
      '#og2-sub{font-size:.82rem;color:#64748b;max-width:240px;line-height:1.6;position:relative}'+

      /* Animated gradient bar */
      '#og2-bar{position:relative;width:56px;height:4px;border-radius:2px;margin-top:22px;'+
        'background:linear-gradient(90deg,#667eea,#a78bfa,#22d3ee,#667eea);'+
        'background-size:200% 100%;animation:og2-bar 1.8s linear infinite}'+
      '@keyframes og2-bar{0%{background-position:0%}100%{background-position:200%}}';

    document.head.appendChild(s);

    /* â”€â”€ Overlay HTML â”€â”€ */
    var d=document.createElement('div');
    d.id=I;
    d.innerHTML=
      '<div id="og2-phone">'+
        '<span id="og2-al">\u2039</span>'+
        '<svg viewBox="0 0 56 90" fill="none" xmlns="http://www.w3.org/2000/svg">'+
          '<rect x="2" y="2" width="52" height="86" rx="10" fill="#1e2535" stroke="#667eea" stroke-width="2.5"/>'+
          '<rect x="7" y="12" width="42" height="62" rx="4" fill="#0d1117" opacity=".9"/>'+
          '<rect x="12" y="22" width="32" height="3" rx="1.5" fill="#667eea" opacity=".7"/>'+
          '<rect x="12" y="30" width="24" height="3" rx="1.5" fill="#667eea" opacity=".5"/>'+
          '<rect x="12" y="38" width="28" height="3" rx="1.5" fill="#667eea" opacity=".35"/>'+
          '<rect x="12" y="46" width="20" height="3" rx="1.5" fill="#a78bfa" opacity=".5"/>'+
          '<rect x="12" y="54" width="26" height="3" rx="1.5" fill="#a78bfa" opacity=".35"/>'+
          '<rect x="20" y="78" width="16" height="3" rx="1.5" fill="#667eea" opacity=".7"/>'+
          '<circle cx="28" cy="7" r="2" fill="#667eea" opacity=".6"/>'+
        '</svg>'+
        '<span id="og2-ar">\u203a</span>'+
      '</div>'+
      '<div id="og2-title"></div>'+
      '<div id="og2-sub"></div>'+
      '<div id="og2-bar"></div>';

    document.body.appendChild(d);
  }

  function update(){
    var o=document.getElementById(I);
    if(!o)return;
    if(needsRotate()){
      var landscape=isTablet();
      o.querySelector('#og2-title').textContent=landscape?'Rotate to landscape':'Rotate to portrait';
      o.querySelector('#og2-sub').textContent=landscape
        ?'This game plays best in landscape mode. Please rotate your tablet.'
        :'This game plays best in portrait mode. Please rotate your phone.';
      o.classList.add('og2-show');
    } else {
      o.classList.remove('og2-show');
    }
  }

  function init(){
    build();
    update();
    window.addEventListener('resize',update);
    window.addEventListener('orientationchange',function(){setTimeout(update,350)});
  }

  document.readyState==='loading'
    ?document.addEventListener('DOMContentLoaded',init)
    :init();
}();

</script>
</body>
</html>
