<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>2048</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{width:100%;height:100%;overflow:hidden}
body{font-family:-apple-system,BlinkMacSystemFont,'Helvetica Neue',sans-serif;background:#1a1a2e;color:#e0e0e0;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;height:100dvh;padding:8px;gap:8px;user-select:none}
h1{font-size:1.8rem;font-weight:800;color:#e94560}
.topbar{display:flex;align-items:center;justify-content:space-between;width:100%;max-width:340px}
.scores{display:flex;gap:6px}
.sbox{background:#16213e;border-radius:6px;padding:4px 12px;text-align:center;min-width:60px}
.sbox .lb{font-size:.5rem;color:#888;text-transform:uppercase;font-weight:700}
.sbox .vl{font-size:1rem;font-weight:800;color:#4fc3f7}
.actions button{font-family:inherit;font-size:.65rem;font-weight:700;padding:6px 12px;border:none;border-radius:6px;background:#e94560;color:#fff;cursor:pointer}
.board{width:100%;max-width:340px;background:#16213e;border-radius:10px;padding:8px;position:relative;touch-action:none}
.bg{display:grid;grid-template-columns:repeat(4,1fr);gap:7px}
.bgc{background:#0f0f23;border-radius:6px;aspect-ratio:1}
.tl{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:800;border-radius:6px;transition:top .12s,left .12s;z-index:1}
.tl.new{animation:pop .2s}.tl.mg{animation:bulge .2s}
@keyframes pop{0%{transform:scale(0)}100%{transform:scale(1)}}
@keyframes bulge{50%{transform:scale(1.12)}100%{transform:scale(1)}}
.ov{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(26,26,46,.9);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;z-index:10;visibility:hidden;opacity:0;transition:opacity .3s}
.ov.show{visibility:visible;opacity:1}
.ov h2{font-size:1.8rem;color:#e94560}.ov p{color:#aaa;font-size:1.1rem}
.ov button{font-family:inherit;padding:12px 28px;border:none;border-radius:30px;background:#e94560;color:#fff;font-size:1rem;font-weight:700;cursor:pointer}
</style>
</head>
<body>
<h1>2048</h1>
<div class="topbar">
  <div class="scores">
    <div class="sbox"><div class="lb">Score</div><div class="vl" id="sc">0</div></div>
    <div class="sbox"><div class="lb">Best</div><div class="vl" id="bs">0</div></div>
  </div>
  <div class="actions"><button id="newBtn">â†» New</button></div>
</div>
<div class="board" id="brd">
  <div class="bg" id="bg"></div>
  <div id="tl" style="position:absolute;top:8px;left:8px;right:8px;bottom:8px"></div>
</div>
<div class="ov" id="ov"><h2 id="ovT"></h2><p id="ovM"></p><button id="ovB">Play Again</button></div>
<script>
(function(){
var SZ=4,grid,score,best=0,tid=0,active;
var brdEl=document.getElementById('brd'),bgEl=document.getElementById('bg'),tlEl=document.getElementById('tl');
var scEl=document.getElementById('sc'),bsEl=document.getElementById('bs');
var ov=document.getElementById('ov'),ovT=document.getElementById('ovT'),ovM=document.getElementById('ovM');

var COLS={
  2:{bg:'#2a3a5e',c:'#4fc3f7',fs:'1.6rem'},
  4:{bg:'#2e4068',c:'#4fc3f7',fs:'1.6rem'},
  8:{bg:'#e94560',c:'#fff',fs:'1.6rem'},
  16:{bg:'#d63851',c:'#fff',fs:'1.5rem'},
  32:{bg:'#c02a42',c:'#fff',fs:'1.5rem'},
  64:{bg:'#a31d33',c:'#fff',fs:'1.5rem'},
  128:{bg:'#ffca28',c:'#1a1a2e',fs:'1.3rem'},
  256:{bg:'#ffc107',c:'#1a1a2e',fs:'1.3rem'},
  512:{bg:'#ff9800',c:'#1a1a2e',fs:'1.3rem'},
  1024:{bg:'#66bb6a',c:'#1a1a2e',fs:'1.1rem'},
  2048:{bg:'#4fc3f7',c:'#1a1a2e',fs:'1.1rem'}
};

for(var i=0;i<16;i++){var d=document.createElement('div');d.className='bgc';bgEl.appendChild(d);}

function init(){
  grid=[];for(var r=0;r<SZ;r++){grid[r]=[];for(var c=0;c<SZ;c++)grid[r][c]=null;}
  score=0;tid=0;active=true;scEl.textContent='0';
  tlEl.innerHTML='';ov.className='ov';
  addRand();addRand();render();
}

function addRand(){
  var e=[];for(var r=0;r<SZ;r++)for(var c=0;c<SZ;c++)if(!grid[r][c])e.push([r,c]);
  if(!e.length)return;var p=e[Math.floor(Math.random()*e.length)];
  grid[p[0]][p[1]]={id:tid++,val:Math.random()<.9?2:4,mg:false,nw:true};
}

function tsz(){var bw=brdEl.offsetWidth-16;return(bw-7*3)/4;}

function render(){
  tlEl.innerHTML='';var s=tsz(),g=7;
  for(var r=0;r<SZ;r++)for(var c=0;c<SZ;c++){
    var t=grid[r][c];if(!t)continue;
    var el=document.createElement('div');el.className='tl';
    if(t.nw)el.classList.add('new');if(t.mg)el.classList.add('mg');
    var cl=COLS[t.val]||{bg:'#ab47bc',c:'#fff',fs:'1rem'};
    el.style.cssText='width:'+s+'px;height:'+s+'px;top:'+r*(s+g)+'px;left:'+c*(s+g)+'px;background:'+cl.bg+';color:'+cl.c+';font-size:'+cl.fs;
    el.textContent=t.val;tlEl.appendChild(el);
    t.nw=false;t.mg=false;
  }
}

function move(dir){
  if(!active)return;var moved=false;
  var dr=dir==='up'?-1:dir==='down'?1:0;
  var dc=dir==='left'?-1:dir==='right'?1:0;
  var rs=dr===1?SZ-1:0,re=dr===1?-1:SZ,ri=dr===1?-1:1;
  var cs=dc===1?SZ-1:0,ce=dc===1?-1:SZ,ci=dc===1?-1:1;
  for(var r=0;r<SZ;r++)for(var c=0;c<SZ;c++)if(grid[r][c])grid[r][c].mg=false;

  for(var r=rs;r!==re;r+=ri)for(var c=cs;c!==ce;c+=ci){
    if(!grid[r][c])continue;
    var nr=r,nc=c;
    while(true){
      var nnr=nr+dr,nnc=nc+dc;
      if(nnr<0||nnr>=SZ||nnc<0||nnc>=SZ)break;
      if(!grid[nnr][nnc]){nr=nnr;nc=nnc;}
      else if(grid[nnr][nnc].val===grid[r][c].val&&!grid[nnr][nnc].mg){nr=nnr;nc=nnc;break;}
      else break;
    }
    if(nr!==r||nc!==c){
      moved=true;
      if(grid[nr][nc]){var nv=grid[r][c].val*2;grid[nr][nc]={id:tid++,val:nv,mg:true,nw:false};score+=nv;}
      else grid[nr][nc]=grid[r][c];
      grid[r][c]=null;
    }
  }
  if(!moved)return;
  addRand();scEl.textContent=score;
  if(score>best){best=score;bsEl.textContent=best;}
  render();
  // Check win
  for(var r=0;r<SZ;r++)for(var c=0;c<SZ;c++){
    if(grid[r][c]&&grid[r][c].val===2048){
      active=false;ovT.textContent='ðŸŽ‰ You Win!';ovM.textContent='Score: '+score;
      setTimeout(function(){ov.className='ov show';},300);return;
    }
  }
  if(!canMove()){
    active=false;ovT.textContent='Game Over';ovM.textContent='Score: '+score;
    setTimeout(function(){ov.className='ov show';},300);
  }
}

function canMove(){
  for(var r=0;r<SZ;r++)for(var c=0;c<SZ;c++){
    if(!grid[r][c])return true;
    if(c<SZ-1&&grid[r][c+1]&&grid[r][c].val===grid[r][c+1].val)return true;
    if(r<SZ-1&&grid[r+1][c]&&grid[r][c].val===grid[r+1][c].val)return true;
  }
  return false;
}

document.addEventListener('keydown',function(e){
  if(e.key==='ArrowUp')move('up');else if(e.key==='ArrowDown')move('down');
  else if(e.key==='ArrowLeft')move('left');else if(e.key==='ArrowRight')move('right');
});
var tx,ty;
brdEl.addEventListener('touchstart',function(e){tx=e.touches[0].clientX;ty=e.touches[0].clientY;},{passive:true});
brdEl.addEventListener('touchend',function(e){
  var dx=e.changedTouches[0].clientX-tx,dy=e.changedTouches[0].clientY-ty;
  if(Math.abs(dx)<25&&Math.abs(dy)<25)return;
  if(Math.abs(dx)>Math.abs(dy))move(dx>0?'right':'left');else move(dy>0?'down':'up');
},{passive:true});
document.getElementById('newBtn').addEventListener('click',init);
document.getElementById('ovB').addEventListener('click',init);
window.addEventListener('resize',render);
init();
})();
</script>
<!-- ORIENTATION GUARD â€” auto shows rotate message when needed -->
<script>
!function(){
  var I='og2-overlay';
  function isTablet(){return Math.min(screen.width,screen.height)>=600}
  function needsRotate(){var l=window.innerWidth>window.innerHeight;return isTablet()?!l:l}

  function build(){
    if(document.getElementById(I))return;

    /* â”€â”€ Styles â”€â”€ */
    var s=document.createElement('style');
    s.textContent=
      '#'+I+'{display:none;position:fixed;inset:0;'+
        'background:linear-gradient(135deg,#0e1218 0%,#1a1f2e 50%,#0e1218 100%);'+
        'z-index:99999;flex-direction:column;align-items:center;justify-content:center;'+
        'font-family:-apple-system,Arial,sans-serif;text-align:center;'+
        'padding:32px;box-sizing:border-box;overflow:hidden}'+
      '#'+I+'.og2-show{display:flex}'+

      /* Glow pulse */
      '#'+I+'::before{content:"";position:absolute;width:300px;height:300px;'+
        'background:radial-gradient(circle,rgba(103,126,234,.18) 0%,transparent 70%);'+
        'border-radius:50%;animation:og2-glow 2.5s ease-in-out infinite}'+
      '@keyframes og2-glow{0%,100%{transform:scale(1);opacity:.5}50%{transform:scale(1.35);opacity:1}}'+

      /* Phone wrap */
      '#og2-phone{position:relative;width:90px;height:90px;'+
        'display:flex;align-items:center;justify-content:center;'+
        'margin-bottom:28px;animation:og2-rot 2.4s ease-in-out infinite}'+
      '@keyframes og2-rot{0%{transform:rotate(0)}35%,65%{transform:rotate(90deg)}100%{transform:rotate(0)}}'+

      /* Phone SVG glow */
      '#og2-phone svg{width:56px;height:90px;'+
        'filter:drop-shadow(0 0 12px rgba(103,126,234,.9)) drop-shadow(0 0 28px rgba(103,126,234,.4))}'+

      /* Arrows */
      '#og2-al,#og2-ar{position:absolute;font-size:24px;opacity:0;'+
        'color:#a78bfa;text-shadow:0 0 10px rgba(167,139,250,.9)}'+
      '#og2-al{left:-2px;animation:og2-ala 2.4s ease-in-out infinite}'+
      '#og2-ar{right:-2px;animation:og2-ara 2.4s ease-in-out infinite}'+
      '@keyframes og2-ala{0%,20%{opacity:0;transform:translateX(6px)}40%{opacity:1;transform:translateX(0)}70%,100%{opacity:0;transform:translateX(-6px)}}'+
      '@keyframes og2-ara{0%,20%{opacity:0;transform:translateX(-6px)}40%{opacity:1;transform:translateX(0)}70%,100%{opacity:0;transform:translateX(6px)}}'+

      /* Title & sub */
      '#og2-title{font-size:1.15rem;font-weight:700;color:#e8edf5;letter-spacing:.05em;margin-bottom:10px;position:relative}'+
      '#og2-sub{font-size:.82rem;color:#64748b;max-width:240px;line-height:1.6;position:relative}'+

      /* Animated gradient bar */
      '#og2-bar{position:relative;width:56px;height:4px;border-radius:2px;margin-top:22px;'+
        'background:linear-gradient(90deg,#667eea,#a78bfa,#22d3ee,#667eea);'+
        'background-size:200% 100%;animation:og2-bar 1.8s linear infinite}'+
      '@keyframes og2-bar{0%{background-position:0%}100%{background-position:200%}}';

    document.head.appendChild(s);

    /* â”€â”€ Overlay HTML â”€â”€ */
    var d=document.createElement('div');
    d.id=I;
    d.innerHTML=
      '<div id="og2-phone">'+
        '<span id="og2-al">\u2039</span>'+
        '<svg viewBox="0 0 56 90" fill="none" xmlns="http://www.w3.org/2000/svg">'+
          '<rect x="2" y="2" width="52" height="86" rx="10" fill="#1e2535" stroke="#667eea" stroke-width="2.5"/>'+
          '<rect x="7" y="12" width="42" height="62" rx="4" fill="#0d1117" opacity=".9"/>'+
          '<rect x="12" y="22" width="32" height="3" rx="1.5" fill="#667eea" opacity=".7"/>'+
          '<rect x="12" y="30" width="24" height="3" rx="1.5" fill="#667eea" opacity=".5"/>'+
          '<rect x="12" y="38" width="28" height="3" rx="1.5" fill="#667eea" opacity=".35"/>'+
          '<rect x="12" y="46" width="20" height="3" rx="1.5" fill="#a78bfa" opacity=".5"/>'+
          '<rect x="12" y="54" width="26" height="3" rx="1.5" fill="#a78bfa" opacity=".35"/>'+
          '<rect x="20" y="78" width="16" height="3" rx="1.5" fill="#667eea" opacity=".7"/>'+
          '<circle cx="28" cy="7" r="2" fill="#667eea" opacity=".6"/>'+
        '</svg>'+
        '<span id="og2-ar">\u203a</span>'+
      '</div>'+
      '<div id="og2-title"></div>'+
      '<div id="og2-sub"></div>'+
      '<div id="og2-bar"></div>';

    document.body.appendChild(d);
  }

  function update(){
    var o=document.getElementById(I);
    if(!o)return;
    if(needsRotate()){
      var landscape=isTablet();
      o.querySelector('#og2-title').textContent=landscape?'Rotate to landscape':'Rotate to portrait';
      o.querySelector('#og2-sub').textContent=landscape
        ?'This game plays best in landscape mode. Please rotate your tablet.'
        :'This game plays best in portrait mode. Please rotate your phone.';
      o.classList.add('og2-show');
    } else {
      o.classList.remove('og2-show');
    }
  }

  function init(){
    build();
    update();
    window.addEventListener('resize',update);
    window.addEventListener('orientationchange',function(){setTimeout(update,350)});
  }

  document.readyState==='loading'
    ?document.addEventListener('DOMContentLoaded',init)
    :init();
}();

</script>
</body>
</html>
