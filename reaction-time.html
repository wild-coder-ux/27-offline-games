<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1">
<title>Reaction Time</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0d0d0f;
  --panel:#141418;
  --border:#2a2a35;
  --text:#e8e8f0;
  --muted:#555566;
  --correct:#00e5a0;
  --wrong:#ff3b5c;
  --warn:#ffc245;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{
  font-family:'DM Mono',monospace;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.scene{
  width:100%;
  max-width:440px;
  padding:20px 16px;
  overflow:hidden;
}

/* MENU */
.menu-screen{text-align:center}
.logo{
  font-family:'Bebas Neue',sans-serif;
  font-size:clamp(1.8rem,11vw,3rem);
  letter-spacing:.08em;
  line-height:1.1;
  background:linear-gradient(135deg,#fff,#555);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
.tagline{font-size:.7rem;color:var(--muted);letter-spacing:.2em;text-transform:uppercase;margin-top:4px;margin-bottom:32px}
.best-display{
  display:inline-block;
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:12px;
  padding:12px 28px;
  margin-bottom:28px;
  font-size:.7rem;
  color:var(--muted);
}
.best-display span{
  display:block;
  font-size:1.5rem;
  color:var(--warn);
  font-family:'Bebas Neue',sans-serif;
  letter-spacing:.08em;
  margin-top:2px;
}
.mode-cards{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px}
.mode-card{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:16px;
  padding:20px 14px;
  cursor:pointer;
  text-align:left;
  transition:border-color .2s,transform .15s;
}
.mode-card:hover{border-color:var(--muted);transform:translateY(-2px)}
.mode-card.selected{border-color:var(--text)}
.mode-icon{font-size:1.5rem;margin-bottom:8px}
.mode-name{font-family:'Bebas Neue',sans-serif;font-size:1.3rem;letter-spacing:.08em}
.mode-desc{font-size:.65rem;color:var(--muted);margin-top:4px;line-height:1.5}
.play-btn{
  width:100%;padding:16px;
  background:var(--text);color:var(--bg);
  border:none;border-radius:14px;
  font-family:'Bebas Neue',sans-serif;font-size:1.4rem;letter-spacing:.12em;
  cursor:pointer;transition:opacity .15s;
}
.play-btn:hover{opacity:.88}
.play-btn:active{opacity:.7}

/* HUD */
.hud{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.hud-item{text-align:center}
.hud-label{font-size:.58rem;color:var(--muted);letter-spacing:.2em;text-transform:uppercase}
.hud-val{font-family:'Bebas Neue',sans-serif;font-size:1.5rem;letter-spacing:.06em;margin-top:2px}
.progress-bar{height:3px;background:var(--border);border-radius:2px;margin-bottom:26px;overflow:hidden}
.progress-fill{height:100%;background:var(--text);border-radius:2px;transition:width .3s}

/* WORD */
.word-area{text-align:center;margin-bottom:30px;min-height:100px;display:flex;flex-direction:column;align-items:center;justify-content:center}
.instruction{font-size:.6rem;color:var(--muted);letter-spacing:.2em;text-transform:uppercase;margin-bottom:12px}
.stroop-word{font-family:'Bebas Neue',sans-serif;font-size:clamp(2.4rem,14vw,4.2rem);letter-spacing:.06em;line-height:1;width:100%;text-align:center;overflow:hidden;white-space:nowrap;}
.stroop-word.anim-correct{animation:wCorrect .3s ease}
.stroop-word.anim-wrong{animation:wWrong .35s ease}
@keyframes wCorrect{0%,100%{opacity:1}40%{opacity:.15;filter:brightness(5)}}
@keyframes wWrong{
  0%{transform:translateX(0)}15%{transform:translateX(-9px)}
  35%{transform:translateX(9px)}55%{transform:translateX(-5px)}
  75%{transform:translateX(5px)}100%{transform:translateX(0)}
}

/* TIMER ARC */
.timer-arc{position:relative;width:52px;height:52px;margin-top:10px}
.timer-arc svg{transform:rotate(-90deg)}
.timer-arc circle{fill:none;stroke:var(--border);stroke-width:3}
.arc-fill{stroke:#ff3b5c;stroke-dasharray:138;stroke-dashoffset:0}
.timer-text{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:.7rem;color:#ff3b5c}

/* CIRCLES */
.circles-wrap{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:18px;
}
.c-btn{
  width:70px;
  height:70px;
  border-radius:50%;
  border:3px solid rgba(255,255,255,0.1);
  cursor:pointer;
  display:block;
  flex-shrink:0;
  transition:transform .12s;
}
.c-btn:hover{transform:scale(1.1)}
.c-btn:active{transform:scale(.85)!important}

/* FEEDBACK */
.feedback{height:28px;display:flex;align-items:center;justify-content:center;margin-top:16px;font-size:.72rem;letter-spacing:.14em;text-transform:uppercase}

/* RESULT */
.result-screen{text-align:center;width:100%;overflow:hidden;}
.result-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(1.8rem,11vw,2.6rem);letter-spacing:.08em;margin-bottom:20px;width:100%;text-align:center;overflow:hidden;}
.new-best{font-size:.68rem;color:var(--warn);letter-spacing:.15em;text-transform:uppercase;margin-bottom:18px}
.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px;width:100%}
.stat-box{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:16px 8px;overflow:hidden;}
.stat-label{font-size:.58rem;color:var(--muted);letter-spacing:.18em;text-transform:uppercase}
.stat-val{font-family:'Bebas Neue',sans-serif;font-size:clamp(1.3rem,7vw,1.9rem);letter-spacing:.04em;margin-top:4px;white-space:nowrap;}
.stat-val.hi{color:var(--correct)}
.result-btns{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.btn-sec{
  padding:14px;background:var(--panel);color:var(--text);
  border:1px solid var(--border);border-radius:12px;
  font-family:'Bebas Neue',sans-serif;font-size:1.1rem;letter-spacing:.1em;
  cursor:pointer;transition:border-color .2s;
}
.btn-sec:hover{border-color:var(--muted)}
</style>
</head>
<body>
<div class="scene" id="app"></div>
<script>
const COLORS=[
  {name:'RED',    hex:'#ff3b5c'},
  {name:'BLUE',   hex:'#4d9fff'},
  {name:'GREEN',  hex:'#00e5a0'},
  {name:'YELLOW', hex:'#ffc245'},
  {name:'PURPLE', hex:'#b96dff'},
];
const ROUNDS=10, HARD_TIME=2500, DELAY=580;
const app=document.getElementById('app');
let mode='easy', state={}, blocked=false;

function palette(){ return mode==='easy'?COLORS.slice(0,3):COLORS; }

function getBest(m){ try{return JSON.parse(localStorage.getItem('rt_best_'+(m||mode)))||null;}catch(e){return null;} }
function saveBest(d){ const b=getBest(); const ok=!b||d.score>b.score; if(ok)localStorage.setItem('rt_best_'+mode,JSON.stringify(d)); return ok; }

/* â”€â”€â”€ MENU â”€â”€â”€ */
function showMenu(){
  blocked=false;
  const best=getBest(mode);
  app.innerHTML=`
    <div class="menu-screen">
      <div class="logo">REACTION TIME</div>
      <div class="tagline">Tap the ink color â€” not the word</div>
      <div class="best-display">
        Personal Best Â· ${mode.toUpperCase()}
        <span>${best ? best.score+' pts' : 'â€”'}</span>
      </div>
      <div class="mode-cards">
        <div class="mode-card ${mode==='easy'?'selected':''}" id="mE">
          <div class="mode-icon">ðŸŽ¯</div>
          <div class="mode-name">Easy</div>
          <div class="mode-desc">3 colors<br>No time limit</div>
        </div>
        <div class="mode-card ${mode==='hard'?'selected':''}" id="mH">
          <div class="mode-icon">âš¡</div>
          <div class="mode-name">Hard</div>
          <div class="mode-desc">5 colors<br>2.5 s each</div>
        </div>
      </div>
      <button class="play-btn" id="playBtn">PLAY</button>
    </div>`;
  document.getElementById('mE').onclick=()=>{mode='easy';showMenu();};
  document.getElementById('mH').onclick=()=>{mode='hard';showMenu();};
  document.getElementById('playBtn').onclick=startGame;
}

/* â”€â”€â”€ GAME START â”€â”€â”€ */
function startGame(){
  state={round:0,score:0,combo:0,correct:0,times:[],tiv:null};
  blocked=false;
  nextRound();
}

/* â”€â”€â”€ NEXT ROUND â”€â”€â”€ */
function nextRound(){
  if(state.round>=ROUNDS){endGame();return;}
  state.round++;
  blocked=false;
  const colors=palette();
  const wordColor=colors[Math.floor(Math.random()*colors.length)];
  let inkColor;
  if(Math.random()<0.65){
    const others=colors.filter(c=>c.name!==wordColor.name);
    inkColor=others[Math.floor(Math.random()*others.length)];
  } else { inkColor=wordColor; }
  state.target=inkColor;
  state.t0=performance.now();
  renderRound(wordColor,inkColor,colors);
  if(mode==='hard'){
    state.timeLeft=HARD_TIME;
    state.tiv=setInterval(()=>{
      state.timeLeft-=50;
      tickArc();
      if(state.timeLeft<=0){ clearInterval(state.tiv); state.tiv=null; pick(null); }
    },50);
  }
}

/* â”€â”€â”€ RENDER â”€â”€â”€ */
function renderRound(wc,ic,colors){
  const pct=((state.round-1)/ROUNDS)*100;
  app.innerHTML=`
    <div>
      <div class="hud">
        <div class="hud-item"><div class="hud-label">Score</div><div class="hud-val" id="hScore">${state.score}</div></div>
        <div class="hud-item"><div class="hud-label">Round</div><div class="hud-val">${state.round}/${ROUNDS}</div></div>
        <div class="hud-item"><div class="hud-label">Combo</div><div class="hud-val" id="hCombo" style="color:${state.combo>1?'#ffc245':'inherit'}">${state.combo>1?'Ã—'+state.combo:'-'}</div></div>
      </div>
      <div class="progress-bar"><div class="progress-fill" style="width:${pct}%"></div></div>
      <div class="word-area">
        <div class="instruction">TAP THE INK COLOR</div>
        <div class="stroop-word" id="sWord" style="color:${ic.hex}">${wc.name}</div>
        ${mode==='hard'?`<div class="timer-arc"><svg width="52" height="52" viewBox="0 0 52 52"><circle cx="26" cy="26" r="22"/><circle cx="26" cy="26" r="22" class="arc-fill" id="arcFill" style="stroke-dashoffset:0"/></svg><div class="timer-text" id="arcTxt">2.5</div></div>`:''}
      </div>
      <div class="circles-wrap" id="cWrap"></div>
      <div class="feedback" id="fb"></div>
    </div>`;

  /* Build circles via JS â€” guarantees background color is applied */
  const wrap=document.getElementById('cWrap');
  colors.forEach(c=>{
    const btn=document.createElement('button');
    btn.className='c-btn';
    btn.dataset.color=c.name;
    btn.style.background=c.hex;
    btn.style.boxShadow=`0 4px 16px ${c.hex}66`;
    wrap.appendChild(btn);
  });

  /* Single delegated listener */
  wrap.addEventListener('click',function(e){
    const btn=e.target.closest('.c-btn');
    if(btn && !blocked) pick(btn.dataset.color);
  });
}

function tickArc(){
  const fill=document.getElementById('arcFill');
  const txt=document.getElementById('arcTxt');
  if(!fill||!txt) return;
  const p=state.timeLeft/HARD_TIME;
  fill.style.strokeDashoffset=138*(1-p);
  txt.textContent=(state.timeLeft/1000).toFixed(1);
  fill.style.stroke=p<.4?'#ff3b5c':p<.7?'#ffc245':'#ff3b5c';
}

/* â”€â”€â”€ PICK â”€â”€â”€ */
function pick(chosen){
  if(blocked) return;
  blocked=true;
  if(state.tiv){clearInterval(state.tiv);state.tiv=null;}
  const rt=Math.round(performance.now()-state.t0);
  const correct=chosen!==null && chosen===state.target.name;
  const fb=document.getElementById('fb');
  const sw=document.getElementById('sWord');

  const flash=(el,cls)=>{ if(el){el.classList.add(cls);} };

  if(chosen===null){
    state.combo=0;
    if(fb) fb.innerHTML=`<span style="color:var(--wrong)">TOO SLOW</span>`;
    // Highlight correct circle
    const cb=document.querySelector(`.c-btn[data-color="${state.target.name}"]`);
    if(cb) cb.style.border='3px solid #fff';
  } else if(correct){
    state.combo++;
    state.correct++;
    state.times.push(rt);
    const pts=10+(state.combo>1?state.combo*2:0);
    state.score+=pts;
    flash(sw,'anim-correct');
    const cb=document.querySelector(`.c-btn[data-color="${chosen}"]`);
    if(cb){ cb.style.border='3px solid #fff'; cb.style.boxShadow='0 0 20px #ffffff99'; }
    if(fb) fb.innerHTML=`<span style="color:var(--correct)">+${pts}${state.combo>1?' Ã—COMBO':''} &nbsp; ${rt}ms</span>`;
    const hs=document.getElementById('hScore');
    const hc=document.getElementById('hCombo');
    if(hs) hs.textContent=state.score;
    if(hc){ hc.textContent=state.combo>1?'Ã—'+state.combo:'-'; hc.style.color=state.combo>1?'#ffc245':'inherit'; }
  } else {
    state.combo=0;
    state.times.push(rt);
    flash(sw,'anim-wrong');
    const wb=document.querySelector(`.c-btn[data-color="${chosen}"]`);
    if(wb){ wb.style.border='3px solid #ff3b5c'; }
    const cb=document.querySelector(`.c-btn[data-color="${state.target.name}"]`);
    if(cb){ cb.style.border='3px solid #fff'; cb.style.boxShadow='0 0 18px #ffffff88'; }
    if(fb) fb.innerHTML=`<span style="color:var(--wrong)">WRONG &nbsp;Â·&nbsp; ${rt}ms</span>`;
  }
  setTimeout(nextRound, DELAY);
}

/* â”€â”€â”€ END â”€â”€â”€ */
function endGame(){
  const avg=state.times.length?Math.round(state.times.reduce((a,b)=>a+b,0)/state.times.length):0;
  const acc=Math.round((state.correct/ROUNDS)*100);
  const isNew=saveBest({score:state.score,avg,acc});
  const grade=acc>=90?'INCREDIBLE!':acc>=70?'GREAT FOCUS':acc>=50?'NOT BAD':'KEEP GOING';
  app.innerHTML=`
    <div class="result-screen">
      <div class="result-title">${grade}</div>
      ${isNew?'<div class="new-best">â˜… New Personal Best â˜…</div>':''}
      <div class="stats-grid">
        <div class="stat-box"><div class="stat-label">Score</div><div class="stat-val hi">${state.score}</div></div>
        <div class="stat-box"><div class="stat-label">Accuracy</div><div class="stat-val">${acc}%</div></div>
        <div class="stat-box"><div class="stat-label">Avg React</div><div class="stat-val">${avg?avg+'ms':'â€”'}</div></div>
        <div class="stat-box"><div class="stat-label">Correct</div><div class="stat-val">${state.correct}/${ROUNDS}</div></div>
      </div>
      <div class="result-btns">
        <button class="btn-sec" id="retryBtn">RETRY</button>
        <button class="play-btn" id="menuBtn" style="font-size:1.1rem">MENU</button>
      </div>
    </div>`;
  document.getElementById('retryBtn').onclick=startGame;
  document.getElementById('menuBtn').onclick=showMenu;
}

showMenu();
</script>
</body>
</html>
