<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Math Sprint</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%}

body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
  background:#0f172a;
  color:#e2e8f0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:space-evenly;
  padding:12px;
  user-select:none;
}

h1{
  font-size:1rem;
  letter-spacing:.2em;
  text-transform:uppercase;
  color:#38bdf8;
}

/* TOP BAR */
.topbar{
  display:flex;
  justify-content:space-between;
  width:100%;
  max-width:420px;
  align-items:center;
}

#restartBtn{
  background:#1e293b;
  border:none;
  color:#94a3b8;
  padding:6px 10px;
  border-radius:8px;
  font-size:.7rem;
  cursor:pointer;
}

.stats{
  display:flex;
  gap:10px;
  font-family:monospace;
  font-weight:700;
  font-size:.9rem;
}

.sc{color:#4ade80}
.st{color:#f87171}
.combo{color:#facc15}
.hs{color:#38bdf8}
.tm{color:#cbd5e1}

/* TIMER BAR */
.progress{
  width:100%;
  max-width:420px;
  height:6px;
  background:#1e293b;
  border-radius:3px;
  overflow:hidden;
}
.bar{
  height:100%;
  background:#38bdf8;
  width:100%;
  transition:width 1s linear;
}

/* QUESTION */
.question{text-align:center}
.expr{
  font-size:clamp(2rem,9vw,3rem);
  font-weight:800;
}
.eq{font-size:1.5rem;color:#38bdf8}

.answer{
  font-size:clamp(2rem,9vw,3rem);
  font-weight:800;
  color:#4ade80;
  min-height:1.2em;
}

.feedback{min-height:1.2em;font-weight:700}
.correct{color:#4ade80}
.wrong{color:#f87171}

/* NUMPAD */
.numpad{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
  width:100%;
  max-width:280px;
}
.numpad button{
  font-size:1.4rem;
  font-weight:800;
  padding:14px 0;
  border:none;
  border-radius:10px;
  background:#1e293b;
  color:#e2e8f0;
  cursor:pointer;
}
.numpad button:active{
  background:#38bdf8;
  color:#000;
}

/* OVERLAY */
.ov{
  position:fixed;
  inset:0;
  background:rgba(15,23,42,.95);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:16px;
  visibility:hidden;
  opacity:0;
  transition:.25s ease;
}
.ov.show{visibility:visible;opacity:1}
.ov h2{color:#38bdf8}
.ov .big{font-size:2rem;font-weight:800;color:#4ade80}
.ov button{
  padding:12px 28px;
  border:none;
  border-radius:30px;
  background:#38bdf8;
  color:#000;
  font-size:1rem;
  font-weight:700;
  cursor:pointer;
}

/* DIFFICULTY */
.dbtn{display:flex;gap:8px}
.dbtn button{
  font-size:.75rem;
  font-weight:700;
  padding:6px 14px;
  border:none;
  border-radius:20px;
  background:#1e293b;
  color:#94a3b8;
  cursor:pointer;
}
.dbtn button.on{
  background:#38bdf8;
  color:#000;
}
</style>
</head>

<body>

<h1>MATH SPRINT</h1>

<div class="topbar">
  <button id="restartBtn">‚èπ Restart</button>
  <div class="stats">
    <span class="sc" id="sc">0</span>
    <span class="st" id="st">0‚úï</span>
    <span class="combo" id="combo">üî•0</span>
    <span class="hs" id="hs">HS:0</span>
    <span class="tm" id="tm">60</span>
  </div>
</div>

<div class="progress"><div class="bar" id="bar"></div></div>

<div class="question">
  <div class="expr" id="expr"></div>
  <div class="eq">=</div>
</div>

<div class="answer" id="ans"></div>
<div class="feedback" id="fb"></div>
<div class="numpad" id="np"></div>

<!-- START SCREEN -->
<div class="ov show" id="startOv">
  <h2>‚ö° Math Sprint</h2>
  <p>Select difficulty</p>
  <div class="dbtn" id="startDiff">
    <button data-d="easy" class="on">Easy</button>
    <button data-d="med">Med</button>
    <button data-d="hard">Hard</button>
  </div>
  <button id="startBtn">Start</button>
</div>

<!-- END SCREEN -->
<div class="ov" id="endOv">
  <h2>‚è± Time's Up!</h2>
  <div class="big" id="finalScore"></div>
  <p id="finalMsg"></p>
  <button id="retryBtn">Play Again</button>
</div>

<script>
(function(){

let diff='easy',correct=0,wrong=0,combo=0,highScore=0;
let timeLeft=60,timer,running=false;
let answer='',curQ;

const exprEl=document.getElementById('expr');
const ansEl=document.getElementById('ans');
const fbEl=document.getElementById('fb');
const barEl=document.getElementById('bar');
const scEl=document.getElementById('sc');
const stEl=document.getElementById('st');
const comboEl=document.getElementById('combo');
const hsEl=document.getElementById('hs');
const tmEl=document.getElementById('tm');
const startOv=document.getElementById('startOv');
const endOv=document.getElementById('endOv');

highScore=parseInt(localStorage.getItem("mathSprintHS")||0);
hsEl.textContent="HS:"+highScore;

/* ---------- QUESTION GENERATOR ---------- */
function genQ(){
  let a,b,op,ans;

  if(diff==='easy'){
    op=['+','-'][Math.floor(Math.random()*2)];
    a=Math.floor(Math.random()*20)+1;
    b=Math.floor(Math.random()*20)+1;
  }
  else if(diff==='med'){
    op=['+','-','√ó'][Math.floor(Math.random()*3)];
    a=Math.floor(Math.random()*60)+1;
    b=Math.floor(Math.random()*60)+1;
  }
else{
    op=['+','-','√ó','√∑'][Math.floor(Math.random()*4)];
    if(op==='√∑'){
      b=Math.floor(Math.random()*12)+2;
      a=b*(Math.floor(Math.random()*12)+2);
    }else{
      a=Math.floor(Math.random()*150)+1;
      b=Math.floor(Math.random()*150)+1;
    }
  }

  if(op==='-' && a<b)[a,b]=[b,a];

  if(op==='+')ans=a+b;
  else if(op==='-')ans=a-b;
  else if(op==='√ó')ans=a*b;
  else ans=a/b;

  if(diff==='hard' && Math.random()<0.3){
    ans*=-1;
    a=-a;
  }

  return {expr:`${a} ${op} ${b}`,ans:ans};
}

/* ---------- GAME FLOW ---------- */
function updateBar(){
  barEl.style.width=(timeLeft/60)*100+"%";
}

function nextQ(){
  curQ=genQ();
  exprEl.textContent=curQ.expr;
  answer='';
  ansEl.textContent='';
  fbEl.textContent='';
}

function submit(){
  if(!running||answer==='')return;

  let num=parseInt(answer);

  if(num===curQ.ans){
    correct++;
    combo++;
    fbEl.textContent="‚úì Correct";
    fbEl.className="feedback correct";
  }else{
    wrong++;
    combo=0;
    fbEl.textContent="‚úï "+curQ.ans;
    fbEl.className="feedback wrong";
  }

  scEl.textContent=correct;
  stEl.textContent=wrong+"‚úï";
  comboEl.textContent="üî•"+combo;

  setTimeout(nextQ,300);
}

function startGame(){
  correct=0;wrong=0;combo=0;timeLeft=60;
  running=true;

  scEl.textContent="0";
  stEl.textContent="0‚úï";
  comboEl.textContent="üî•0";
  tmEl.textContent="60";
  barEl.style.width="100%";

  startOv.classList.remove("show");
  endOv.classList.remove("show");

  nextQ();

  timer=setInterval(()=>{
    timeLeft--;
    tmEl.textContent=timeLeft;
    updateBar();

    if(timeLeft<=0){
      clearInterval(timer);
      running=false;

      if(correct>highScore){
        highScore=correct;
        localStorage.setItem("mathSprintHS",highScore);
        hsEl.textContent="HS:"+highScore;
      }

      let total=correct+wrong;
      let accuracy=total>0?Math.round((correct/total)*100):0;

      document.getElementById("finalScore").textContent=correct+" correct";
      document.getElementById("finalMsg").textContent=
        wrong+" wrong ¬∑ "+accuracy+"% accuracy";

      endOv.classList.add("show");
    }
  },1000);
}

function stopGame(){
  clearInterval(timer);
  running=false;
  startOv.classList.add("show");
}

/* ---------- INPUT ---------- */
function addDigit(d){
  if(!running)return;
  if(answer.length<6){
    answer+=d;
    ansEl.textContent=answer;
  }
}

function toggleNeg(){
  if(!running)return;
  if(answer.startsWith('-'))answer=answer.slice(1);
  else if(answer!=='')answer='-'+answer;
  ansEl.textContent=answer;
}

function delDigit(){
  if(!running)return;
  answer=answer.slice(0,-1);
  ansEl.textContent=answer;
}

const np=document.getElementById('np');
for(let i=1;i<=9;i++){
  let b=document.createElement('button');
  b.textContent=i;
  b.onclick=()=>addDigit(i);
  np.appendChild(b);
}

let neg=document.createElement('button');
neg.textContent='¬±';
neg.onclick=toggleNeg;
np.appendChild(neg);

let zero=document.createElement('button');
zero.textContent='0';
zero.onclick=()=>addDigit(0);
np.appendChild(zero);

let enter=document.createElement('button');
enter.textContent='‚úì';
enter.onclick=submit;
np.appendChild(enter);

document.addEventListener('keydown',e=>{
  if(!running)return;
  if(e.key>='0'&&e.key<='9')addDigit(e.key);
  if(e.key==='Enter')submit();
  if(e.key==='Backspace')delDigit();
  if(e.key==='-')toggleNeg();
});

/* ---------- DIFFICULTY ---------- */
document.querySelectorAll("#startDiff button").forEach(btn=>{
  btn.onclick=()=>{
    diff=btn.dataset.d;
    document.querySelectorAll("#startDiff button")
      .forEach(b=>b.classList.remove("on"));
    btn.classList.add("on");
  };
});

/* ---------- BUTTONS ---------- */
document.getElementById("startBtn").onclick=startGame;
document.getElementById("retryBtn").onclick=startGame;
document.getElementById("restartBtn").onclick=()=>{
  if(running){
    if(confirm("Stop current game and change difficulty?")){
      stopGame();
    }
  }
};

})();
</script>
<!-- ORIENTATION GUARD ‚Äî auto shows rotate message when needed -->
<script>
!function(){
  var I='og2-overlay';
  function isTablet(){return Math.min(screen.width,screen.height)>=600}
  function needsRotate(){var l=window.innerWidth>window.innerHeight;return isTablet()?!l:l}

  function build(){
    if(document.getElementById(I))return;

    /* ‚îÄ‚îÄ Styles ‚îÄ‚îÄ */
    var s=document.createElement('style');
    s.textContent=
      '#'+I+'{display:none;position:fixed;inset:0;'+
        'background:linear-gradient(135deg,#0e1218 0%,#1a1f2e 50%,#0e1218 100%);'+
        'z-index:99999;flex-direction:column;align-items:center;justify-content:center;'+
        'font-family:-apple-system,Arial,sans-serif;text-align:center;'+
        'padding:32px;box-sizing:border-box;overflow:hidden}'+
      '#'+I+'.og2-show{display:flex}'+

      /* Glow pulse */
      '#'+I+'::before{content:"";position:absolute;width:300px;height:300px;'+
        'background:radial-gradient(circle,rgba(103,126,234,.18) 0%,transparent 70%);'+
        'border-radius:50%;animation:og2-glow 2.5s ease-in-out infinite}'+
      '@keyframes og2-glow{0%,100%{transform:scale(1);opacity:.5}50%{transform:scale(1.35);opacity:1}}'+

      /* Phone wrap */
      '#og2-phone{position:relative;width:90px;height:90px;'+
        'display:flex;align-items:center;justify-content:center;'+
        'margin-bottom:28px;animation:og2-rot 2.4s ease-in-out infinite}'+
      '@keyframes og2-rot{0%{transform:rotate(0)}35%,65%{transform:rotate(90deg)}100%{transform:rotate(0)}}'+

      /* Phone SVG glow */
      '#og2-phone svg{width:56px;height:90px;'+
        'filter:drop-shadow(0 0 12px rgba(103,126,234,.9)) drop-shadow(0 0 28px rgba(103,126,234,.4))}'+

      /* Arrows */
      '#og2-al,#og2-ar{position:absolute;font-size:24px;opacity:0;'+
        'color:#a78bfa;text-shadow:0 0 10px rgba(167,139,250,.9)}'+
      '#og2-al{left:-2px;animation:og2-ala 2.4s ease-in-out infinite}'+
      '#og2-ar{right:-2px;animation:og2-ara 2.4s ease-in-out infinite}'+
      '@keyframes og2-ala{0%,20%{opacity:0;transform:translateX(6px)}40%{opacity:1;transform:translateX(0)}70%,100%{opacity:0;transform:translateX(-6px)}}'+
      '@keyframes og2-ara{0%,20%{opacity:0;transform:translateX(-6px)}40%{opacity:1;transform:translateX(0)}70%,100%{opacity:0;transform:translateX(6px)}}'+

      /* Title & sub */
      '#og2-title{font-size:1.15rem;font-weight:700;color:#e8edf5;letter-spacing:.05em;margin-bottom:10px;position:relative}'+
      '#og2-sub{font-size:.82rem;color:#64748b;max-width:240px;line-height:1.6;position:relative}'+

      /* Animated gradient bar */
      '#og2-bar{position:relative;width:56px;height:4px;border-radius:2px;margin-top:22px;'+
        'background:linear-gradient(90deg,#667eea,#a78bfa,#22d3ee,#667eea);'+
        'background-size:200% 100%;animation:og2-bar 1.8s linear infinite}'+
      '@keyframes og2-bar{0%{background-position:0%}100%{background-position:200%}}';

    document.head.appendChild(s);

    /* ‚îÄ‚îÄ Overlay HTML ‚îÄ‚îÄ */
    var d=document.createElement('div');
    d.id=I;
    d.innerHTML=
      '<div id="og2-phone">'+
        '<span id="og2-al">\u2039</span>'+
        '<svg viewBox="0 0 56 90" fill="none" xmlns="http://www.w3.org/2000/svg">'+
          '<rect x="2" y="2" width="52" height="86" rx="10" fill="#1e2535" stroke="#667eea" stroke-width="2.5"/>'+
          '<rect x="7" y="12" width="42" height="62" rx="4" fill="#0d1117" opacity=".9"/>'+
          '<rect x="12" y="22" width="32" height="3" rx="1.5" fill="#667eea" opacity=".7"/>'+
          '<rect x="12" y="30" width="24" height="3" rx="1.5" fill="#667eea" opacity=".5"/>'+
          '<rect x="12" y="38" width="28" height="3" rx="1.5" fill="#667eea" opacity=".35"/>'+
          '<rect x="12" y="46" width="20" height="3" rx="1.5" fill="#a78bfa" opacity=".5"/>'+
          '<rect x="12" y="54" width="26" height="3" rx="1.5" fill="#a78bfa" opacity=".35"/>'+
          '<rect x="20" y="78" width="16" height="3" rx="1.5" fill="#667eea" opacity=".7"/>'+
          '<circle cx="28" cy="7" r="2" fill="#667eea" opacity=".6"/>'+
        '</svg>'+
        '<span id="og2-ar">\u203a</span>'+
      '</div>'+
      '<div id="og2-title"></div>'+
      '<div id="og2-sub"></div>'+
      '<div id="og2-bar"></div>';

    document.body.appendChild(d);
  }

  function update(){
    var o=document.getElementById(I);
    if(!o)return;
    if(needsRotate()){
      var landscape=isTablet();
      o.querySelector('#og2-title').textContent=landscape?'Rotate to landscape':'Rotate to portrait';
      o.querySelector('#og2-sub').textContent=landscape
        ?'This game plays best in landscape mode. Please rotate your tablet.'
        :'This game plays best in portrait mode. Please rotate your phone.';
      o.classList.add('og2-show');
    } else {
      o.classList.remove('og2-show');
    }
  }

  function init(){
    build();
    update();
    window.addEventListener('resize',update);
    window.addEventListener('orientationchange',function(){setTimeout(update,350)});
  }

  document.readyState==='loading'
    ?document.addEventListener('DOMContentLoaded',init)
    :init();
}();

</script>
</body>
</html>
